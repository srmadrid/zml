// Evaluate P[n] x^n  +  P[n-1] x^(n-1)  +  ...  +  P[0]
pub fn neval(x: f128, p: []const f128, n: i32) f128 {
    var i: i32 = n;
    var y: f128 = p[@intCast(i)];
    i -= 1;
    while (i >= 0) {
        y = y * x + p[@intCast(i)];
        i -= 1;
    }

    return y;
}

// Evaluate x^n+1  +  P[n] x^(n)  +  P[n-1] x^(n-1)  +  ...  +  P[0]
pub fn deval(x: f128, p: []const f128, n: i32) f128 {
    var i: i32 = n;
    var y: f128 = p[@intCast(i)] + x;
    i -= 1;
    while (i >= 0) {
        y = y * x + p[@intCast(i)];
        i -= 1;
    }

    return y;
}

// 2/sqrt(pi) - 1
pub const efx_128: f128 = 1.2837916709551257389615890312154517168810e-1;
// 8 * (2/sqrt(pi) - 1)
pub const efx8_128: f128 = 1.0270333367641005911692712249723613735048e0;

// erf(x)  = x  + x R(x^2)
// 0 <= x <= 7/8
// Peak relative error 1.8e-35
pub const TN1_128: [9]f128 = .{
    -3.858252324254637124543172907442106422373e10,
    9.580319248590464682316366876952214879858e10,
    1.302170519734879977595901236693040544854e10,
    2.922956950426397417800321486727032845006e9,
    1.764317520783319397868923218385468729799e8,
    1.573436014601118630105796794840834145120e7,
    4.028077380105721388745632295157816229289e5,
    1.644056806467289066852135096352853491530e4,
    3.390868480059991640235675479463287886081e1,
};
pub const TD1_128: [9]f128 = .{
    -3.005357030696532927149885530689529032152e11,
    -1.342602283126282827411658673839982164042e11,
    -2.777153893355340961288511024443668743399e10,
    -3.483826391033531996955620074072768276974e9,
    -2.906321047071299585682722511260895227921e8,
    -1.653347985722154162439387878512427542691e7,
    -6.245520581562848778466500301865173123136e5,
    -1.402124304177498828590239373389110545142e4,
    -1.209368072473510674493129989468348633579e2,
};
// erf(z+1)  = erf_const + P(z)/Q(z)
// -.125 <= z <= 0
// Peak relative error 7.3e-36
pub const erf_const_128: f128 = 0.845062911510467529296875;
pub const TN2_128: [9]f128 = .{
    -4.088889697077485301010486931817357000235e1,
    7.157046430681808553842307502826960051036e3,
    -2.191561912574409865550015485451373731780e3,
    2.180174916555316874988981177654057337219e3,
    2.848578658049670668231333682379720943455e2,
    1.630362490952512836762810462174798925274e2,
    6.317712353961866974143739396865293596895e0,
    2.450441034183492434655586496522857578066e1,
    5.127662277706787664956025545897050896203e-1,
};
pub const TD2_128: [9]f128 = .{
    1.731026445926834008273768924015161048885e4,
    1.209682239007990370796112604286048173750e4,
    1.160950290217993641320602282462976163857e4,
    5.394294645127126577825507169061355698157e3,
    2.791239340533632669442158497532521776093e3,
    8.989365571337319032943005387378993827684e2,
    2.974016493766349409725385710897298069677e2,
    6.148192754590376378740261072533527271947e1,
    1.178502892490738445655468927408440847480e1,
};
// erfc(x + 0.25) = erfc(0.25) + x R(x)
// 0 <= x < 0.125
// Peak relative error 1.4e-35
pub const RNr13_128: [9]f128 = .{
    -2.353707097641280550282633036456457014829e3,
    3.871159656228743599994116143079870279866e2,
    -3.888105134258266192210485617504098426679e2,
    -2.129998539120061668038806696199343094971e1,
    -8.125462263594034672468446317145384108734e1,
    8.151549093983505810118308635926270319660e0,
    -5.033362032729207310462422357772568553670e0,
    -4.253956621135136090295893547735851168471e-2,
    -8.098602878463854789780108161581050357814e-2,
};
pub const RDr13_128: [8]f128 = .{
    2.220448796306693503549505450626652881752e3,
    1.899133258779578688791041599040951431383e2,
    1.061906712284961110196427571557149268454e3,
    7.497086072306967965180978101974566760042e1,
    2.146796115662672795876463568170441327274e2,
    1.120156008362573736664338015952284925592e1,
    2.211014952075052616409845051695042741074e1,
    6.469655675326150785692908453094054988938e-1,
};
// erfc(0.25) = C13a + C13b to extra precision.
pub const C13a_128: f128 = 0.723663330078125;
pub const C13b_128: f128 = 1.0279753638067014931732235184287934646022e-5;
// erfc(x + 0.375) = erfc(0.375) + x R(x)
// 0 <= x < 0.125
// Peak relative error 1.2e-35
pub const RNr14_128: [9]f128 = .{
    -2.446164016404426277577283038988918202456e3,
    6.718753324496563913392217011618096698140e2,
    -4.581631138049836157425391886957389240794e2,
    -2.382844088987092233033215402335026078208e1,
    -7.119237852400600507927038680970936336458e1,
    1.313609646108420136332418282286454287146e1,
    -6.188608702082264389155862490056401365834e0,
    -2.787116601106678287277373011101132659279e-2,
    -2.230395570574153963203348263549700967918e-2,
};
pub const RDr14_128: [8]f128 = .{
    2.495187439241869732696223349840963702875e3,
    2.503549449872925580011284635695738412162e2,
    1.159033560988895481698051531263861842461e3,
    9.493751466542304491261487998684383688622e1,
    2.276214929562354328261422263078480321204e2,
    1.367697521219069280358984081407807931847e1,
    2.276988395995528495055594829206582732682e1,
    7.647745753648996559837591812375456641163e-1,
};
// erfc(0.375) = C14a + C14b to extra precision.
pub const C14a_128: f128 = 0.5958709716796875;
pub const C14b_128: f128 = 1.2118885490201676174914080878232469565953e-5;
// erfc(x + 0.5) = erfc(0.5) + x R(x)
// 0 <= x < 0.125
// Peak relative error 4.7e-36
pub const RNr15_128: [9]f128 = .{
    -2.624212418011181487924855581955853461925e3,
    8.473828904647825181073831556439301342756e2,
    -5.286207458628380765099405359607331669027e2,
    -3.895781234155315729088407259045269652318e1,
    -6.200857908065163618041240848728398496256e1,
    1.469324610346924001393137895116129204737e1,
    -6.961356525370658572800674953305625578903e0,
    5.145724386641163809595512876629030548495e-3,
    1.990253655948179713415957791776180406812e-2,
};
pub const RDr15_128: [8]f128 = .{
    2.986190760847974943034021764693341524962e3,
    5.288262758961073066335410218650047725985e2,
    1.363649178071006978355113026427856008978e3,
    1.921707975649915894241864988942255320833e2,
    2.588651100651029023069013885900085533226e2,
    2.628752920321455606558942309396855629459e1,
    2.455649035885114308978333741080991380610e1,
    1.378826653595128464383127836412100939126e0,
};
// erfc(0.5) = C15a + C15b to extra precision.
pub const C15a_128: f128 = 0.4794921875;
pub const C15b_128: f128 = 7.9346869534623172533461080354712635484242e-6;
// erfc(x + 0.625) = erfc(0.625) + x R(x)
// 0 <= x < 0.125
// Peak relative error 5.1e-36
pub const RNr16_128: [9]f128 = .{
    -2.347887943200680563784690094002722906820e3,
    8.008590660692105004780722726421020136482e2,
    -5.257363310384119728760181252132311447963e2,
    -4.471737717857801230450290232600243795637e1,
    -4.849540386452573306708795324759300320304e1,
    1.140885264677134679275986782978655952843e1,
    -6.731591085460269447926746876983786152300e0,
    1.370831653033047440345050025876085121231e-1,
    2.022958279982138755020825717073966576670e-2,
};
pub const RDr16_128: [8]f128 = .{
    3.075166170024837215399323264868308087281e3,
    8.730468942160798031608053127270430036627e2,
    1.458472799166340479742581949088453244767e3,
    3.230423687568019709453130785873540386217e2,
    2.804009872719893612081109617983169474655e2,
    4.465334221323222943418085830026979293091e1,
    2.612723259683205928103787842214809134746e1,
    2.341526751185244109722204018543276124997e0,
};
// erfc(0.625) = C16a + C16b to extra precision.
pub const C16a_128: f128 = 0.3767547607421875;
pub const C16b_128: f128 = 4.3570693945275513594941232097252997287766e-6;
// erfc(x + 0.75) = erfc(0.75) + x R(x)
// 0 <= x < 0.125
// Peak relative error 1.7e-35
pub const RNr17_128: [9]f128 = .{
    -1.767068734220277728233364375724380366826e3,
    6.693746645665242832426891888805363898707e2,
    -4.746224241837275958126060307406616817753e2,
    -2.274160637728782675145666064841883803196e1,
    -3.541232266140939050094370552538987982637e1,
    6.988950514747052676394491563585179503865e0,
    -5.807687216836540830881352383529281215100e0,
    3.631915988567346438830283503729569443642e-1,
    -1.488945487149634820537348176770282391202e-2,
};
pub const RDr17_128: [8]f128 = .{
    2.748457523498150741964464942246913394647e3,
    1.020213390713477686776037331757871252652e3,
    1.388857635935432621972601695296561952738e3,
    3.903363681143817750895999579637315491087e2,
    2.784568344378139499217928969529219886578e2,
    5.555800830216764702779238020065345401144e1,
    2.646215470959050279430447295801291168941e1,
    2.984905282103517497081766758550112011265e0,
};
// erfc(0.75) = C17a + C17b to extra precision.
pub const C17a_128: f128 = 0.2888336181640625;
pub const C17b_128: f128 = 1.0748182422368401062165408589222625794046e-5;
// erfc(x + 0.875) = erfc(0.875) + x R(x)
// 0 <= x < 0.125
// Peak relative error 2.2e-35
pub const RNr18_128: [9]f128 = .{
    -1.342044899087593397419622771847219619588e3,
    6.127221294229172997509252330961641850598e2,
    -4.519821356522291185621206350470820610727e2,
    1.223275177825128732497510264197915160235e1,
    -2.730789571382971355625020710543532867692e1,
    4.045181204921538886880171727755445395862e0,
    -4.925146477876592723401384464691452700539e0,
    5.933878036611279244654299924101068088582e-1,
    -5.557645435858916025452563379795159124753e-2,
};
pub const RDr18_128: [8]f128 = .{
    2.557518000661700588758505116291983092951e3,
    1.070171433382888994954602511991940418588e3,
    1.344842834423493081054489613250688918709e3,
    4.161144478449381901208660598266288188426e2,
    2.763670252219855198052378138756906980422e2,
    5.998153487868943708236273854747564557632e1,
    2.657695108438628847733050476209037025318e1,
    3.252140524394421868923289114410336976512e0,
};
// erfc(0.875) = C18a + C18b to extra precision.
pub const C18a_128: f128 = 0.215911865234375;
pub const C18b_128: f128 = 1.3073705765341685464282101150637224028267e-5;
// erfc(x + 1.0) = erfc(1.0) + x R(x)
// 0 <= x < 0.125
// Peak relative error 1.6e-35
pub const RNr19_128: [9]f128 = .{
    -1.139180936454157193495882956565663294826e3,
    6.134903129086899737514712477207945973616e2,
    -4.628909024715329562325555164720732868263e2,
    4.165702387210732352564932347500364010833e1,
    -2.286979913515229747204101330405771801610e1,
    1.870695256449872743066783202326943667722e0,
    -4.177486601273105752879868187237000032364e0,
    7.533980372789646140112424811291782526263e-1,
    -8.629945436917752003058064731308767664446e-2,
};
pub const RDr19_128: [8]f128 = .{
    2.744303447981132701432716278363418643778e3,
    1.266396359526187065222528050591302171471e3,
    1.466739461422073351497972255511919814273e3,
    4.868710570759693955597496520298058147162e2,
    2.993694301559756046478189634131722579643e2,
    6.868976819510254139741559102693828237440e1,
    2.801505816247677193480190483913753613630e1,
    3.604439909194350263552750347742663954481e0,
};
// erfc(1.0) = C19a + C19b to extra precision.
pub const C19a_128: f128 = 0.15728759765625;
pub const C19b_128: f128 = 1.1609394035130658779364917390740703933002e-5;
// erfc(x + 1.125) = erfc(1.125) + x R(x)
// 0 <= x < 0.125
// Peak relative error 3.6e-36
pub const RNr20_128: [9]f128 = .{
    -9.652706916457973956366721379612508047640e2,
    5.577066396050932776683469951773643880634e2,
    -4.406335508848496713572223098693575485978e2,
    5.202893466490242733570232680736966655434e1,
    -1.931311847665757913322495948705563937159e1,
    -9.364318268748287664267341457164918090611e-2,
    -3.306390351286352764891355375882586201069e0,
    7.573806045289044647727613003096916516475e-1,
    -9.611744011489092894027478899545635991213e-2,
};
pub const RDr20_128: [8]f128 = .{
    3.032829629520142564106649167182428189014e3,
    1.659648470721967719961167083684972196891e3,
    1.703545128657284619402511356932569292535e3,
    6.393465677731598872500200253155257708763e2,
    3.489131397281030947405287112726059221934e2,
    8.848641738570783406484348434387611713070e1,
    3.132269062552392974833215844236160958502e1,
    4.430131663290563523933419966185230513168e0,
};
// erfc(1.125) = C20a + C20b to extra precision.
pub const C20a_128: f128 = 0.111602783203125;
pub const C20b_128: f128 = 8.9850951672359304215530728365232161564636e-6;
// erfc(1/x) = 1/x exp (-1/x^2 - 0.5625 + R(1/x^2))
// 7/8 <= 1/x < 1
// Peak relative error 1.4e-35
pub const RNr8_128: [10]f128 = .{
    3.587451489255356250759834295199296936784e1,
    5.406249749087340431871378009874875889602e2,
    2.931301290625250886238822286506381194157e3,
    7.359254185241795584113047248898753470923e3,
    9.201031849810636104112101947312492532314e3,
    5.749697096193191467751650366613289284777e3,
    1.710415234419860825710780802678697889231e3,
    2.150753982543378580859546706243022719599e2,
    8.740953582272147335100537849981160931197e0,
    4.876422978828717219629814794707963640913e-2,
};
pub const RDr8_128: [9]f128 = .{
    6.358593134096908350929496535931630140282e1,
    9.900253816552450073757174323424051765523e2,
    5.642928777856801020545245437089490805186e3,
    1.524195375199570868195152698617273739609e4,
    2.113829644500006749947332935305800887345e4,
    1.526438562626465706267943737310282977138e4,
    5.561370922149241457131421914140039411782e3,
    9.394035530179705051609070428036834496942e2,
    6.147019596150394577984175188032707343615e1,
};
// erfc(1/x) = 1/x exp (-1/x^2 - 0.5625 + R(1/x^2))
// 0.75 <= 1/x <= 0.875
// Peak relative error 2.0e-36
pub const RNr7_128: [10]f128 = .{
    1.686222193385987690785945787708644476545e1,
    1.178224543567604215602418571310612066594e3,
    1.764550584290149466653899886088166091093e4,
    1.073758321890334822002849369898232811561e5,
    3.132840749205943137619839114451290324371e5,
    4.607864939974100224615527007793867585915e5,
    3.389781820105852303125270837910972384510e5,
    1.174042187110565202875011358512564753399e5,
    1.660013606011167144046604892622504338313e4,
    6.700393957480661937695573729183733234400e2,
};
pub const RDr7_128: [10]f128 = .{
    -1.709305024718358874701575813642933561169e3,
    -3.280033887481333199580464617020514788369e4,
    -2.345284228022521885093072363418750835214e5,
    -8.086758123097763971926711729242327554917e5,
    -1.456900414510108718402423999575992450138e6,
    -1.391654264881255068392389037292702041855e6,
    -6.842360801869939983674527468509852583855e5,
    -1.597430214446573566179675395199807533371e5,
    -1.488876130609876681421645314851760773480e4,
    -3.511762950935060301403599443436465645703e2,
};
// erfc(1/x) = 1/x exp(-1/x^2 - 0.5625 + R(1/x^2))
// 5/8 <= 1/x < 3/4
// Peak relative error 1.9e-35
pub const RNr6_128: [10]f128 = .{
    1.642076876176834390623842732352935761108e0,
    1.207150003611117689000664385596211076662e2,
    2.119260779316389904742873816462800103939e3,
    1.562942227734663441801452930916044224174e4,
    5.656779189549710079988084081145693580479e4,
    1.052166241021481691922831746350942786299e5,
    9.949798524786000595621602790068349165758e4,
    4.491790734080265043407035220188849562856e4,
    8.377074098301530326270432059434791287601e3,
    4.506934806567986810091824791963991057083e2,
};
pub const RDr6_128: [10]f128 = .{
    -1.664557643928263091879301304019826629067e2,
    -3.800035902507656624590531122291160668452e3,
    -3.277028191591734928360050685359277076056e4,
    -1.381359471502885446400589109566587443987e5,
    -3.082204287382581873532528989283748656546e5,
    -3.691071488256738343008271448234631037095e5,
    -2.300482443038349815750714219117566715043e5,
    -6.873955300927636236692803579555752171530e4,
    -8.262158817978334142081581542749986845399e3,
    -2.517122254384430859629423488157361983661e2,
};
// erfc(1/x) = 1/x exp(-1/x^2 - 0.5625 + R(1/x^2))
// 1/2 <= 1/x < 5/8
// Peak relative error 4.6e-36
pub const RNr5_128: [11]f128 = .{
    -3.332258927455285458355550878136506961608e-3,
    -2.697100758900280402659586595884478660721e-1,
    -6.083328551139621521416618424949137195536e0,
    -6.119863528983308012970821226810162441263e1,
    -3.176535282475593173248810678636522589861e2,
    -8.933395175080560925809992467187963260693e2,
    -1.360019508488475978060917477620199499560e3,
    -1.075075579828188621541398761300910213280e3,
    -4.017346561586014822824459436695197089916e2,
    -5.857581368145266249509589726077645791341e1,
    -2.077715925587834606379119585995758954399e0,
};
pub const RDr5_128: [10]f128 = .{
    3.377879570417399341550710467744693125385e-1,
    1.021963322742390735430008860602594456187e1,
    1.200847646592942095192766255154827011939e2,
    7.118915528142927104078182863387116942836e2,
    2.318159380062066469386544552429625026238e3,
    4.238729853534009221025582008928765281620e3,
    4.279114907284825886266493994833515580782e3,
    2.257277186663261531053293222591851737504e3,
    5.570475501285054293371908382916063822957e2,
    5.142189243856288981145786492585432443560e1,
};
// erfc(1/x) = 1/x exp(-1/x^2 - 0.5625 + R(1/x^2))
// 3/8 <= 1/x < 1/2
// Peak relative error 2.0e-36
pub const RNr4_128: [11]f128 = .{
    3.258530712024527835089319075288494524465e-3,
    2.987056016877277929720231688689431056567e-1,
    8.738729089340199750734409156830371528862e0,
    1.207211160148647782396337792426311125923e2,
    8.997558632489032902250523945248208224445e2,
    3.798025197699757225978410230530640879762e3,
    9.113203668683080975637043118209210146846e3,
    1.203285891339933238608683715194034900149e4,
    8.100647057919140328536743641735339740855e3,
    2.383888249907144945837976899822927411769e3,
    2.127493573166454249221983582495245662319e2,
};
pub const RDr4_128: [11]f128 = .{
    -3.303141981514540274165450687270180479586e-1,
    -1.353768629363605300707949368917687066724e1,
    -2.206127630303621521950193783894598987033e2,
    -1.861800338758066696514480386180875607204e3,
    -8.889048775872605708249140016201753255599e3,
    -2.465888106627948210478692168261494857089e4,
    -3.934642211710774494879042116768390014289e4,
    -3.455077258242252974937480623730228841003e4,
    -1.524083977439690284820586063729912653196e4,
    -2.810541887397984804237552337349093953857e3,
    -1.343929553541159933824901621702567066156e2,
};
// erfc(1/x) = 1/x exp(-1/x^2 - 0.5625 + R(1/x^2))
// 1/4 <= 1/x < 3/8
// Peak relative error 8.4e-37
pub const RNr3_128: [12]f128 = .{
    -1.952401126551202208698629992497306292987e-6,
    -2.130881743066372952515162564941682716125e-4,
    -8.376493958090190943737529486107282224387e-3,
    -1.650592646560987700661598877522831234791e-1,
    -1.839290818933317338111364667708678163199e0,
    -1.216278715570882422410442318517814388470e1,
    -4.818759344462360427612133632533779091386e1,
    -1.120994661297476876804405329172164436784e2,
    -1.452850765662319264191141091859300126931e2,
    -9.485207851128957108648038238656777241333e1,
    -2.563663855025796641216191848818620020073e1,
    -1.787995944187565676837847610706317833247e0,
};
pub const RDr3_128: [11]f128 = .{
    1.979130686770349481460559711878399476903e-4,
    1.156941716128488266238105813374635099057e-2,
    2.752657634309886336431266395637285974292e-1,
    3.482245457248318787349778336603569327521e0,
    2.569347069372696358578399521203959253162e1,
    1.142279000180457419740314694631879921561e2,
    3.056503977190564294341422623108332700840e2,
    4.780844020923794821656358157128719184422e2,
    4.105972727212554277496256802312730410518e2,
    1.724072188063746970865027817017067646246e2,
    2.815939183464818198705278118326590370435e1,
};
// erfc(1/x) = 1/x exp(-1/x^2 - 0.5625 + R(1/x^2))
// 1/8 <= 1/x < 1/4
// Peak relative error 1.5e-36
pub const RNr2_128: [12]f128 = .{
    -2.638914383420287212401687401284326363787e-8,
    -3.479198370260633977258201271399116766619e-6,
    -1.783985295335697686382487087502222519983e-4,
    -4.777876933122576014266349277217559356276e-3,
    -7.450634738987325004070761301045014986520e-2,
    -7.068318854874733315971973707247467326619e-1,
    -4.113919921935944795764071670806867038732e0,
    -1.440447573226906222417767283691888875082e1,
    -2.883484031530718428417168042141288943905e1,
    -2.990886974328476387277797361464279931446e1,
    -1.325283914915104866248279787536128997331e1,
    -1.572436106228070195510230310658206154374e0,
};
pub const RDr2_128: [11]f128 = .{
    2.675042728136731923554119302571867799673e-6,
    2.170997868451812708585443282998329996268e-4,
    7.249969752687540289422684951196241427445e-3,
    1.302040375859768674620410563307838448508e-1,
    1.380202483082910888897654537144485285549e0,
    8.926594113174165352623847870299170069350e0,
    3.521089584782616472372909095331572607185e1,
    8.233547427533181375185259050330809105570e1,
    1.072971579885803033079469639073292840135e2,
    6.943803113337964469736022094105143158033e1,
    1.775695341031607738233608307835017282662e1,
};
// erfc(1/x) = 1/x exp(-1/x^2 - 0.5625 + R(1/x^2))
// 1/128 <= 1/x < 1/8
// Peak relative error 2.2e-36
pub const RNr1_128: [10]f128 = .{
    -4.250780883202361946697751475473042685782e-8,
    -5.375777053288612282487696975623206383019e-6,
    -2.573645949220896816208565944117382460452e-4,
    -6.199032928113542080263152610799113086319e-3,
    -8.262721198693404060380104048479916247786e-2,
    -6.242615227257324746371284637695778043982e-1,
    -2.609874739199595400225113299437099626386e0,
    -5.581967563336676737146358534602770006970e0,
    -5.124398923356022609707490956634280573882e0,
    -1.290865243944292370661544030414667556649e0,
};
pub const RDr1_128: [9]f128 = .{
    4.308976661749509034845251315983612976224e-6,
    3.265390126432780184125233455960049294580e-4,
    9.811328839187040701901866531796570418691e-3,
    1.511222515036021033410078631914783519649e-1,
    1.289264341917429958858379585970225092274e0,
    6.147640356182230769548007536914983522270e0,
    1.573966871337739784518246317003956180750e1,
    1.955534123435095067199574045529218238263e1,
    9.472613121363135472247929109615785855865e0,
};
