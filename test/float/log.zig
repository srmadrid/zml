const std = @import("std");
const zml = @import("zml");
const log = zml.float.log;
const tzml = @import("../zml.zig");

const data_f32: [39]struct { f32, f32 } = .{
    .{ 0x0p+0, 0x1p+0 },
    .{ 0x1p+0, 0x2.b7e154p+0 },
    .{ 0xf.fffffp-4, 0x2.b7e15p+0 },
    .{ -0x1p+0, 0x5.e2d59p-4 },
    .{ -0x1p+0, 0x5.e2d588p-4 },
    .{ 0xb.17218p-4, 0x2p+0 },
    .{ 0x2.4d7638p+0, 0xap+0 },
    .{ -0x4.9a5888p-4, 0xcp-4 },
    .{ 0x1.fffffep-24, 0x1.000002p+0 },
    .{ 0x1.fffffep-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0x1.fffffep-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0x1.fffffep-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0x1.fffffep-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1p-24, 0xf.fffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1p-24, 0xf.fffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1p-24, 0xf.fffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1p-24, 0xf.fffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1p-24, 0xf.fffffp-4 },
    .{ -0x5.75628p+4, 0x4p-128 },
    .{ -0x6.74768p+4, 0x8p-152 },
    .{ 0x5.8b90cp+4, 0xf.fffffp+124 },
    .{ -0x5.eb58f8p-4, 0xb.0d5dfp-4 },
    .{ 0x5.a47afp-4, 0x1.6c3f6p+0 },
    .{ -0x6.772d38p-4, 0xa.ae688p-4 },
    .{ 0x1.e811a8p+4, 0x1.017f8ap+44 },
    .{ 0x1.8ff28cp+4, 0x1.0b5c1ep+36 },
    .{ 0x5.8b90cp+4, 0xf.fffffp+124 },
    .{ 0x7.3eb07p-4, 0x1.929d9cp+0 },
    .{ 0x6.1ba94p-4, 0x1.770072p+0 },
    .{ -0x1.6fe0dp-4, 0xe.a0289p-4 },
    .{ -0x1.6fe0e2p-4, 0xe.a0288p-4 },
};

const data_f64: [57]struct { f64, f64 } = .{
    .{ 0x0p+0, 0x1p+0 },
    .{ 0x1.000000f647926p+0, 0x2.b7e154p+0 },
    .{ 0xf.fffff7d922f5p-4, 0x2.b7e15p+0 },
    .{ 0x1p+0, 0x2.b7e151628aed4p+0 },
    .{ 0x1p+0, 0x2.b7e151628aed2p+0 },
    .{ -0xf.fffff952d5f5p-4, 0x5.e2d59p-4 },
    .{ -0x1.000000f11e086p+0, 0x5.e2d588p-4 },
    .{ -0x1p+0, 0x5.e2d58d8b3bcep-4 },
    .{ -0x1.0000000000001p+0, 0x5.e2d58d8b3bcdcp-4 },
    .{ 0xb.17217f7d1cf78p-4, 0x2p+0 },
    .{ 0x2.4d763776aaa2cp+0, 0xap+0 },
    .{ -0x4.9a58844d36e48p-4, 0xcp-4 },
    .{ 0x1.fffffe000002bp-24, 0x1.000002p+0 },
    .{ 0x1.fffffe000002bp-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffe000002bp-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffe000002bp-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffe000002bp-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8p-56, 0x1.0000000000001p+0 },
    .{ -0x1.0000008000005p-24, 0xf.fffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005p-24, 0xf.fffffp-4 },
    .{ -0x8p-56, 0xf.ffffffffffff8p-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005p-24, 0xf.fffffp-4 },
    .{ -0x8p-56, 0xf.ffffffffffff8p-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005p-24, 0xf.fffffp-4 },
    .{ -0x8p-56, 0xf.ffffffffffff8p-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005p-24, 0xf.fffffp-4 },
    .{ -0x8p-56, 0xf.ffffffffffff8p-4 },
    .{ -0x5.75627cbf9441cp+4, 0x4p-128 },
    .{ -0x2.c4657baf579a4p+8, 0x4p-1024 },
    .{ -0x2.9fa8dcb9092a6p+8, 0x8p-972 },
    .{ -0x6.74767f33d1dcp+4, 0x8p-152 },
    .{ -0x2.e870a88dae386p+8, 0x4p-1076 },
    .{ 0x5.8b90bfae8e7bcp+4, 0xf.fffffp+124 },
    .{ 0x2.c5c85fdf473dep+8, 0xf.ffffffffffff8p+1020 },
    .{ -0x5.eb58f885a32d8p-4, 0xb.0d5dfp-4 },
    .{ 0x5.a47aee2b5c35p-4, 0x1.6c3f6p+0 },
    .{ -0x6.772d36f0dd28cp-4, 0xa.ae688p-4 },
    .{ 0x1.e811a8a66aa57p+4, 0x1.017f8ap+44 },
    .{ 0x1.8ff28cfed79a1p+4, 0x1.0b5c1ep+36 },
    .{ 0x5.8b90bfae8e7bcp+4, 0xf.fffffp+124 },
    .{ 0x2.83fc3c37fc59p+8, 0x2.1b17c2887e938p+928 },
    .{ 0x7.3eb06c60714c4p-4, 0x1.929d9cp+0 },
    .{ 0x6.1ba943bb20434p-4, 0x1.770072p+0 },
    .{ -0x1.6fe0d0a6311e3p-4, 0xe.a0289p-4 },
    .{ -0x1.6fe0e22718ad7p-4, 0xe.a0288p-4 },
    .{ -0x1.6fe0d4c400979p-4, 0xe.a0288c3cb5ecp-4 },
};

const data_f80: [71]struct { f80, f80 } = .{
    .{ 0x0p+0, 0x1p+0 },
    .{ 0x1.000000f647925f34p+0, 0x2.b7e154p+0 },
    .{ 0xf.fffff7d922f51a3p-4, 0x2.b7e15p+0 },
    .{ 0x1.00000000000007fp+0, 0x2.b7e151628aed4p+0 },
    .{ 0xf.ffffffffffffc2bp-4, 0x2.b7e151628aed2p+0 },
    .{ 0x1p+0, 0x2.b7e151628aed2a6cp+0 },
    .{ 0xf.fffffffffffffffp-4, 0x2.b7e151628aed2a68p+0 },
    .{ -0xf.fffff952d5f52b9p-4, 0x5.e2d59p-4 },
    .{ -0x1.000000f11e085f42p+0, 0x5.e2d588p-4 },
    .{ -0xf.ffffffffffffd91p-4, 0x5.e2d58d8b3bcep-4 },
    .{ -0x1.000000000000087p+0, 0x5.e2d58d8b3bcdcp-4 },
    .{ -0xf.fffffffffffffffp-4, 0x5.e2d58d8b3bcdf1bp-4 },
    .{ -0x1p+0, 0x5.e2d58d8b3bcdf1a8p-4 },
    .{ 0xb.17217f7d1cf79acp-4, 0x2p+0 },
    .{ 0x2.4d763776aaa2b05cp+0, 0xap+0 },
    .{ -0x4.9a58844d36e49e1p-4, 0xcp-4 },
    .{ 0x1.fffffe000002aaaap-24, 0x1.000002p+0 },
    .{ 0x1.fffffe000002aaaap-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffe000002aaaap-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffffffffffffep-64, 0x1.0000000000000002p+0 },
    .{ 0x1.fffffe000002aaaap-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffffffffffffep-64, 0x1.0000000000000002p+0 },
    .{ 0x1.fffffe000002aaaap-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffffffffffffep-64, 0x1.0000000000000002p+0 },
    .{ -0x1.0000008000005556p-24, 0xf.fffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005556p-24, 0xf.fffffp-4 },
    .{ -0x8.0000000000002p-56, 0xf.ffffffffffff8p-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005556p-24, 0xf.fffffp-4 },
    .{ -0x8.0000000000002p-56, 0xf.ffffffffffff8p-4 },
    .{ -0x1p-64, 0xf.fffffffffffffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005556p-24, 0xf.fffffp-4 },
    .{ -0x8.0000000000002p-56, 0xf.ffffffffffff8p-4 },
    .{ -0x1p-64, 0xf.fffffffffffffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005556p-24, 0xf.fffffp-4 },
    .{ -0x8.0000000000002p-56, 0xf.ffffffffffff8p-4 },
    .{ -0x1p-64, 0xf.fffffffffffffffp-4 },
    .{ -0x5.75627cbf9441de28p+4, 0x4p-128 },
    .{ -0x2.c4657baf579a47bcp+8, 0x4p-1024 },
    .{ -0x2.c5b2319c4843accp+12, 0x4p-16384 },
    .{ -0x2.c5bd48bdc7c0c9b8p+12, 0x2p-16384 },
    .{ -0x2.9fa8dcb9092a538cp+8, 0x8p-972 },
    .{ -0x6.74767f33d1dc1d1p+4, 0x8p-152 },
    .{ -0x2.e870a88dae386c74p+8, 0x4p-1076 },
    .{ -0x2.c86ce2daa80dcdbp+12, 0x8p-16448 },
    .{ 0x5.8b90bfae8e7bc56p+4, 0xf.fffffp+124 },
    .{ 0x2.c5c85fdf473de6a8p+8, 0xf.ffffffffffff8p+1020 },
    .{ 0x2.c5c85fdf473de6bp+12, 0xf.fffffffffffffffp+16380 },
    .{ -0x5.eb58f885a32d894p-4, 0xb.0d5dfp-4 },
    .{ 0x5.a47aee2b5c34f8p-4, 0x1.6c3f6p+0 },
    .{ -0x6.772d36f0dd28c27p-4, 0xa.ae688p-4 },
    .{ 0x1.e811a8a66aa56988p+4, 0x1.017f8ap+44 },
    .{ 0x1.8ff28cfed79a1002p+4, 0x1.0b5c1ep+36 },
    .{ 0x5.8b90bfae8e7bc56p+4, 0xf.fffffp+124 },
    .{ 0x2.83fc3c37fc59p+8, 0x2.1b17c2887e938p+928 },
    .{ 0x7.3eb06c60714c5ff8p-4, 0x1.929d9cp+0 },
    .{ 0x6.1ba943bb20434dc8p-4, 0x1.770072p+0 },
    .{ -0x1.6fe0d0a6311e31f2p-4, 0xe.a0289p-4 },
    .{ -0x1.6fe0e22718ad7752p-4, 0xe.a0288p-4 },
    .{ -0x1.6fe0d4c40097884ep-4, 0xe.a0288c3cb5ecp-4 },
};

const data_f128: [89]struct { f128, f128 } = .{
    .{ 0x0p+0, 0x1p+0 },
    .{ 0x1.000000f647925f34d03716a8b6ccp+0, 0x2.b7e154p+0 },
    .{ 0xf.fffff7d922f51a2d208d1c4e821p-4, 0x2.b7e15p+0 },
    .{ 0x1.00000000000007f0a06e4ddb0222p+0, 0x2.b7e151628aed4p+0 },
    .{ 0xf.ffffffffffffc2af553376366578p-4, 0x2.b7e151628aed2p+0 },
    .{ 0x1.000000000000000075ed29d49ac4p+0, 0x2.b7e151628aed2a6cp+0 },
    .{ 0xf.ffffffffffffffefd37c671cbd08p-4, 0x2.b7e151628aed2a68p+0 },
    .{ 0x1p+0, 0x2.b7e151628aed2a6abf7158809cf6p+0 },
    .{ 0xf.fffffffffffffffffffffffffff8p-4, 0x2.b7e151628aed2a6abf7158809cf4p+0 },
    .{ 0x1.0000000000000000000000000004p+0, 0x2.b7e151628aed2a6abf7158809dp+0 },
    .{ 0xf.fffffffffffffffffffffffffa6p-4, 0x2.b7e151628aed2a6abf7158809cp+0 },
    .{ -0xf.fffff952d5f52b972627765c7b8p-4, 0x5.e2d59p-4 },
    .{ -0x1.000000f11e085f422347d5acdb97p+0, 0x5.e2d588p-4 },
    .{ -0xf.ffffffffffffd90c7882a506a588p-4, 0x5.e2d58d8b3bcep-4 },
    .{ -0x1.00000000000008704ccdb47c1f23p+0, 0x5.e2d58d8b3bcdcp-4 },
    .{ -0xf.fffffffffffffff4415f776b07c8p-4, 0x5.e2d58d8b3bcdf1bp-4 },
    .{ -0x1.0000000000000000a006a027f5f3p+0, 0x5.e2d58d8b3bcdf1a8p-4 },
    .{ -0x1p+0, 0x5.e2d58d8b3bcdf1abadec7829055p-4 },
    .{ -0x1.0000000000000000000000000001p+0, 0x5.e2d58d8b3bcdf1abadec7829054cp-4 },
    .{ -0xf.fffffffffffffffffffffffffe2p-4, 0x5.e2d58d8b3bcdf1abadec782906p-4 },
    .{ -0x1.0000000000000000000000000039p+0, 0x5.e2d58d8b3bcdf1abadec782904p-4 },
    .{ 0xb.17217f7d1cf79abc9e3b39803f3p-4, 0x2p+0 },
    .{ 0x2.4d763776aaa2b05ba95b58ae0b4cp+0, 0xap+0 },
    .{ -0x4.9a58844d36e49e0efadd9db02aa8p-4, 0xcp-4 },
    .{ 0x1.fffffe000002aaaaa6aaaab11111p-24, 0x1.000002p+0 },
    .{ 0x1.fffffe000002aaaaa6aaaab11111p-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8000000000000558p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffe000002aaaaa6aaaab11111p-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8000000000000558p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffffffffffffep-64, 0x1.0000000000000002p+0 },
    .{ 0x1.fffffe000002aaaaa6aaaab11111p-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8000000000000558p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffffffffffffep-64, 0x1.0000000000000002p+0 },
    .{ 0x7.fffffffffffffffffffffffffep-108, 0x1.000000000000000000000000008p+0 },
    .{ 0x1.fffffe000002aaaaa6aaaab11111p-24, 0x1.000002p+0 },
    .{ 0x0p+0, 0x1p+0 },
    .{ 0xf.ffffffffffff8000000000000558p-56, 0x1.0000000000001p+0 },
    .{ 0x1.fffffffffffffffep-64, 0x1.0000000000000002p+0 },
    .{ 0xf.fffffffffffffffffffffffffff8p-116, 0x1.0000000000000000000000000001p+0 },
    .{ 0x7.fffffffffffffffffffffffffep-108, 0x1.000000000000000000000000008p+0 },
    .{ -0x1.0000008000005555559555558889p-24, 0xf.fffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005555559555558889p-24, 0xf.fffffp-4 },
    .{ -0x8.00000000000020000000000000a8p-56, 0xf.ffffffffffff8p-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005555559555558889p-24, 0xf.fffffp-4 },
    .{ -0x8.00000000000020000000000000a8p-56, 0xf.ffffffffffff8p-4 },
    .{ -0x1.00000000000000008p-64, 0xf.fffffffffffffffp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005555559555558889p-24, 0xf.fffffp-4 },
    .{ -0x8.00000000000020000000000000a8p-56, 0xf.ffffffffffff8p-4 },
    .{ -0x1.00000000000000008p-64, 0xf.fffffffffffffffp-4 },
    .{ -0x4.000000000000000000000000008p-108, 0xf.fffffffffffffffffffffffffcp-4 },
    .{ 0x0p+0, 0x1p+0 },
    .{ -0x1.0000008000005555559555558889p-24, 0xf.fffffp-4 },
    .{ -0x8.00000000000020000000000000a8p-56, 0xf.ffffffffffff8p-4 },
    .{ -0x1.00000000000000008p-64, 0xf.fffffffffffffffp-4 },
    .{ -0x8p-116, 0xf.fffffffffffffffffffffffffff8p-4 },
    .{ -0x4.000000000000000000000000008p-108, 0xf.fffffffffffffffffffffffffcp-4 },
    .{ -0x5.75627cbf9441de28d5e1264d1f18p+4, 0x4p-128 },
    .{ -0x2.c4657baf579a47bbcffb06f8dfc4p+8, 0x4p-1024 },
    .{ -0x2.c5b2319c4843acbff21591e99cccp+12, 0x4p-16384 },
    .{ -0x2.c5bd48bdc7c0c9b78cd23024d64cp+12, 0x2p-16384 },
    .{ -0x2.9fa8dcb9092a538b3f2ee2ca66f2p+8, 0x8p-972 },
    .{ -0x6.74767f33d1dc1d0fc8187877a4c8p+4, 0x8p-152 },
    .{ -0x2.e870a88dae386c72b4fd4773c092p+8, 0x4p-1076 },
    .{ -0x2.c86ce2daa80dcdaf0680827cc35ap+12, 0x8p-16448 },
    .{ -0x2.c877f9fc278aeaa6a13d20b7fcdcp+12, 0x4p-16448 },
    .{ -0x2.ca8c50440f005913a49acbd2c4e8p+12, 0x4p-16496 },
    .{ 0x5.8b90bfae8e7bc55e4f18476ac644p+4, 0xf.fffffp+124 },
    .{ 0x2.c5c85fdf473de6a7278ece600fccp+8, 0xf.ffffffffffff8p+1020 },
    .{ 0x2.c5c85fdf473de6af277ece600fccp+12, 0xf.fffffffffffffffp+16380 },
    .{ 0x2.c5c85fdf473de6af278ece600fccp+12, 0xf.fffffffffffffffffffffffffff8p+16380 },
    .{ 0x2.c5c85fdf473de6ab278ece600fccp+8, 0xf.ffffffffffffbffffffffffffcp+1020 },
    .{ -0x5.eb58f885a32d893cb272dbe106p-4, 0xb.0d5dfp-4 },
    .{ 0x5.a47aee2b5c34f7fed8c38bb73dc4p-4, 0x1.6c3f6p+0 },
    .{ -0x6.772d36f0dd28c26cc42127335304p-4, 0xa.ae688p-4 },
    .{ 0x1.e811a8a66aa569880c5e8ea2ec2p+4, 0x1.017f8ap+44 },
    .{ 0x1.8ff28cfed79a1001419ce243f3acp+4, 0x1.0b5c1ep+36 },
    .{ 0x5.8b90bfae8e7bc55e4f18476ac644p+4, 0xf.fffffp+124 },
    .{ 0x2.83fc3c37fc58ffff8f99749ff1e6p+8, 0x2.1b17c2887e938p+928 },
    .{ 0x7.3eb06c60714c5ffbcdb915af2664p-4, 0x1.929d9cp+0 },
    .{ 0x6.1ba943bb20434dc4abd932bca664p-4, 0x1.770072p+0 },
    .{ -0x1.6fe0d0a6311e31f19855212ae415p-4, 0xe.a0289p-4 },
    .{ -0x1.6fe0e22718ad77516665df92f5dbp-4, 0xe.a0288p-4 },
    .{ -0x1.6fe0d4c40097884d86068c297d0cp-4, 0xe.a0288c3cb5ecp-4 },
};

test log {
    for (data_f32) |test_case| {
        try tzml.expectApproxEqAbs(
            test_case[0],
            log(test_case[1]),
            std.math.floatEpsAt(f32, test_case[0]),
        );
    }

    for (data_f64) |test_case| {
        try tzml.expectApproxEqAbs(
            test_case[0],
            log(test_case[1]),
            std.math.floatEpsAt(f64, test_case[0]),
        );
    }

    for (data_f80) |test_case| {
        try tzml.expectApproxEqAbs(
            test_case[0],
            log(test_case[1]),
            std.math.floatEpsAt(f80, test_case[0]),
        );
    }

    for (data_f128) |test_case| {
        try tzml.expectApproxEqAbs(
            test_case[0],
            log(test_case[1]),
            std.math.floatEpsAt(f128, test_case[0]),
        );
    }
}
