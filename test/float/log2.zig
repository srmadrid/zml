const std = @import("std");
const zml = @import("zml");
const log2 = zml.float.log2;

test log2 {
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    try std.testing.expectEqual(0x1.715478p+0, log2(@as(f32, 0x2.b7e154p+0)));
    try std.testing.expectEqual(0x1.715476p+0, log2(@as(f32, 0x2.b7e15p+0)));
    try std.testing.expectEqual(0x1p+0, log2(@as(f32, 0x2p+0)));
    try std.testing.expectEqual(0x4p+0, log2(@as(f32, 0x1p+4)));
    try std.testing.expectEqual(0x8p+0, log2(@as(f32, 0x1p+8)));
    try std.testing.expectEqual(-0x6.a3fe6p-4, log2(@as(f32, 0xcp-4)));
    try std.testing.expectEqual(0x2.e2a8e8p-24, log2(@as(f32, 0x1.000002p+0)));
    try std.testing.expectEqual(0x2.e2a8e8p-24, log2(@as(f32, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    try std.testing.expectEqual(0x2.e2a8e8p-24, log2(@as(f32, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    try std.testing.expectEqual(0x2.e2a8e8p-24, log2(@as(f32, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    try std.testing.expectEqual(0x2.e2a8e8p-24, log2(@as(f32, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    // try std.testing.expectEqual(-0x1.715478p-24, log2(@as(f32, 0xf.fffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    // try std.testing.expectEqual(-0x1.715478p-24, log2(@as(f32, 0xf.fffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    // try std.testing.expectEqual(-0x1.715478p-24, log2(@as(f32, 0xf.fffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    // try std.testing.expectEqual(-0x1.715478p-24, log2(@as(f32, 0xf.fffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f32, 0x1p+0)));
    // try std.testing.expectEqual(-0x1.715478p-24, log2(@as(f32, 0xf.fffffp-4)));
    try std.testing.expectEqual(0x3.6a6848p-4, log2(@as(f32, 0x1.28d3b4p+0)));
    try std.testing.expectEqual(-0x1.b8bdeep-4, log2(@as(f32, 0xe.d99dap-4)));
    try std.testing.expectEqual(0x7.999f28p-4, log2(@as(f32, 0x1.63d204p+0)));
    try std.testing.expectEqual(0x7.999f08p-4, log2(@as(f32, 0x1.63d202p+0)));
    try std.testing.expectEqual(-0x3.75cc4p-8, log2(@as(f32, 0xf.d9ce1p-4)));
    try std.testing.expectEqual(-0x3.75cdb4p-8, log2(@as(f32, 0xf.d9cep-4)));
    try std.testing.expectEqual(0xa.59594p-8, log2(@as(f32, 0x1.07465cp+0)));
    try std.testing.expectEqual(0xa.59567p-8, log2(@as(f32, 0x1.07465ap+0)));
    try std.testing.expectEqual(-0x2.c10694p+4, log2(@as(f32, 0xf.4dfb4p-48)));
    try std.testing.expectEqual(0xe.a1dd4p-8, log2(@as(f32, 0x1.0a588ep+0)));
    try std.testing.expectEqual(-0x6.d35688p-4, log2(@as(f32, 0xb.e77c6p-4)));
    try std.testing.expectEqual(0x6.44f93p-4, log2(@as(f32, 0x1.4fe37ep+0)));
    try std.testing.expectEqual(0x9.d9a8cp+0, log2(@as(f32, 0x3.9b0754p+8)));
    try std.testing.expectEqual(-0x6.df8b3p-4, log2(@as(f32, 0xb.e132ap-4)));
    try std.testing.expectEqual(-0x7.e84208p-4, log2(@as(f32, 0xb.5bf83p-4)));
    try std.testing.expectEqual(-0x7.e84228p-4, log2(@as(f32, 0xb.5bf82p-4)));
    try std.testing.expectEqual(-0x7.b18b68p-4, log2(@as(f32, 0xb.7704ep-4)));
    try std.testing.expectEqual(-0x7.b18b88p-4, log2(@as(f32, 0xb.7704dp-4)));
    try std.testing.expectEqual(-0x7.f27148p-4, log2(@as(f32, 0xb.56f64p-4)));
    try std.testing.expectEqual(-0x7.f27168p-4, log2(@as(f32, 0xb.56f63p-4)));
    try std.testing.expectEqual(-0x7.f84a98p-4, log2(@as(f32, 0xb.54171p-4)));
    try std.testing.expectEqual(-0x7.f84ab8p-4, log2(@as(f32, 0xb.5417p-4)));
    try std.testing.expectEqual(-0x7.ep+4, log2(@as(f32, 0x4p-128)));
    try std.testing.expectEqual(-0x9.5p+4, log2(@as(f32, 0x8p-152)));
    try std.testing.expectEqual(0x8p+4, log2(@as(f32, 0xf.fffffp+124)));

    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(0x1.715477b6069b3p+0, log2(@as(f64, 0x2.b7e154p+0)));
    try std.testing.expectEqual(0x1.715475968cddcp+0, log2(@as(f64, 0x2.b7e15p+0)));
    try std.testing.expectEqual(0x1.71547652b82ffp+0, log2(@as(f64, 0x2.b7e151628aed4p+0)));
    try std.testing.expectEqual(0x1.71547652b82fep+0, log2(@as(f64, 0x2.b7e151628aed2p+0)));
    try std.testing.expectEqual(0x1p+0, log2(@as(f64, 0x2p+0)));
    try std.testing.expectEqual(0x4p+0, log2(@as(f64, 0x1p+4)));
    try std.testing.expectEqual(0x8p+0, log2(@as(f64, 0x1p+8)));
    try std.testing.expectEqual(-0x6.a3fe5c6042978p-4, log2(@as(f64, 0xcp-4)));
    try std.testing.expectEqual(0x2.e2a8e9c2c777p-24, log2(@as(f64, 0x1.000002p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c777p-24, log2(@as(f64, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fdp-52, log2(@as(f64, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c777p-24, log2(@as(f64, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fdp-52, log2(@as(f64, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c777p-24, log2(@as(f64, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fdp-52, log2(@as(f64, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c777p-24, log2(@as(f64, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fdp-52, log2(@as(f64, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b8p-24, log2(@as(f64, 0xf.fffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b8p-24, log2(@as(f64, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17fp-56, log2(@as(f64, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b8p-24, log2(@as(f64, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17fp-56, log2(@as(f64, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b8p-24, log2(@as(f64, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17fp-56, log2(@as(f64, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f64, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b8p-24, log2(@as(f64, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17fp-56, log2(@as(f64, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(0x3.6a6846287159cp-4, log2(@as(f64, 0x1.28d3b4p+0)));
    try std.testing.expectEqual(-0x1.b8bdee5bd4282p-4, log2(@as(f64, 0xe.d99dap-4)));
    try std.testing.expectEqual(0x7.999f2a94857b4p-4, log2(@as(f64, 0x1.63d204p+0)));
    try std.testing.expectEqual(0x7.999f095d7e15p-4, log2(@as(f64, 0x1.63d202p+0)));
    try std.testing.expectEqual(0x7.999f16e03b55p-4, log2(@as(f64, 0x1.63d202d04392cp+0)));
    try std.testing.expectEqual(-0x3.75cc3f2233d66p-8, log2(@as(f64, 0xf.d9ce1p-4)));
    try std.testing.expectEqual(-0x3.75cdb3f0a0b66p-8, log2(@as(f64, 0xf.d9cep-4)));
    try std.testing.expectEqual(-0x3.75ccb13d89cc6p-8, log2(@as(f64, 0xf.d9ce0b1a50e08p-4)));
    try std.testing.expectEqual(0xa.5959448ade0cp-8, log2(@as(f64, 0x1.07465cp+0)));
    try std.testing.expectEqual(0xa.5956764b14aap-8, log2(@as(f64, 0x1.07465ap+0)));
    try std.testing.expectEqual(0xa.595912bb7fffp-8, log2(@as(f64, 0x1.07465bdc7e41cp+0)));
    try std.testing.expectEqual(0xa.595912bb7fe88p-8, log2(@as(f64, 0x1.07465bdc7e41bp+0)));
    try std.testing.expectEqual(-0x2.c106931f2bfdp+4, log2(@as(f64, 0xf.4dfb4p-48)));
    try std.testing.expectEqual(0xe.a1dd43a221dp-8, log2(@as(f64, 0x1.0a588ep+0)));
    try std.testing.expectEqual(-0x6.d35688edc44a4p-4, log2(@as(f64, 0xb.e77c6p-4)));
    try std.testing.expectEqual(0x6.44f92e0fda7dp-4, log2(@as(f64, 0x1.4fe37ep+0)));
    try std.testing.expectEqual(0x9.d9a8c6de34328p+0, log2(@as(f64, 0x3.9b0754p+8)));
    try std.testing.expectEqual(-0x6.df8b2c2c5ea4p-4, log2(@as(f64, 0xb.e132ap-4)));
    try std.testing.expectEqual(-0x7.e842050c531dp-4, log2(@as(f64, 0xb.5bf83p-4)));
    try std.testing.expectEqual(-0x7.e842258fcc5d8p-4, log2(@as(f64, 0xb.5bf82p-4)));
    try std.testing.expectEqual(-0x7.e8420994680dcp-4, log2(@as(f64, 0xb.5bf82dc51f028p-4)));
    try std.testing.expectEqual(-0x7.e8420994680ecp-4, log2(@as(f64, 0xb.5bf82dc51f02p-4)));
    try std.testing.expectEqual(-0x7.b18b6b68ffa24p-4, log2(@as(f64, 0xb.7704ep-4)));
    try std.testing.expectEqual(-0x7.b18b8b9fc309cp-4, log2(@as(f64, 0xb.7704dp-4)));
    try std.testing.expectEqual(-0x7.b18b723cc4c5p-4, log2(@as(f64, 0xb.7704dc9beb05p-4)));
    try std.testing.expectEqual(-0x7.f27149af9dc8cp-4, log2(@as(f64, 0xb.56f64p-4)));
    try std.testing.expectEqual(-0x7.f2716a4172a7p-4, log2(@as(f64, 0xb.56f63p-4)));
    try std.testing.expectEqual(-0x7.f27151a15d70cp-4, log2(@as(f64, 0xb.56f63c18e93fp-4)));
    try std.testing.expectEqual(-0x7.f27151a15d71cp-4, log2(@as(f64, 0xb.56f63c18e93e8p-4)));
    try std.testing.expectEqual(-0x7.f84a9424a2fbcp-4, log2(@as(f64, 0xb.54171p-4)));
    try std.testing.expectEqual(-0x7.f84ab4beb988cp-4, log2(@as(f64, 0xb.5417p-4)));
    try std.testing.expectEqual(-0x7.f84a998412a44p-4, log2(@as(f64, 0xb.54170d5cfa9p-4)));
    try std.testing.expectEqual(-0x7.f84a998412a54p-4, log2(@as(f64, 0xb.54170d5cfa8f8p-4)));
    try std.testing.expectEqual(-0x7.ep+4, log2(@as(f64, 0x4p-128)));
    try std.testing.expectEqual(-0x3.fep+8, log2(@as(f64, 0x4p-1024)));
    try std.testing.expectEqual(-0x3.c9p+8, log2(@as(f64, 0x8p-972)));
    try std.testing.expectEqual(-0x9.5p+4, log2(@as(f64, 0x8p-152)));
    try std.testing.expectEqual(-0x4.32p+8, log2(@as(f64, 0x4p-1076)));
    try std.testing.expectEqual(0x7.ffffffe8eab88p+4, log2(@as(f64, 0xf.fffffp+124)));
    try std.testing.expectEqual(0x4p+8, log2(@as(f64, 0xf.ffffffffffff8p+1020)));

    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(0x1.715477b6069b2d4cp+0, log2(@as(f80, 0x2.b7e154p+0)));
    try std.testing.expectEqual(0x1.715475968cddc4e6p+0, log2(@as(f80, 0x2.b7e15p+0)));
    try std.testing.expectEqual(0x1.71547652b82fececp+0, log2(@as(f80, 0x2.b7e151628aed4p+0)));
    try std.testing.expectEqual(0x1.71547652b82fdbfp+0, log2(@as(f80, 0x2.b7e151628aed2p+0)));
    try std.testing.expectEqual(0x1.71547652b82fe178p+0, log2(@as(f80, 0x2.b7e151628aed2a6cp+0)));
    try std.testing.expectEqual(0x1.71547652b82fe176p+0, log2(@as(f80, 0x2.b7e151628aed2a68p+0)));
    try std.testing.expectEqual(0x1p+0, log2(@as(f80, 0x2p+0)));
    try std.testing.expectEqual(0x4p+0, log2(@as(f80, 0x1p+4)));
    try std.testing.expectEqual(0x8p+0, log2(@as(f80, 0x1p+8)));
    try std.testing.expectEqual(-0x6.a3fe5c6042978608p-4, log2(@as(f80, 0xcp-4)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f66p-24, log2(@as(f80, 0x1.000002p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f66p-24, log2(@as(f80, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fd5ecp-52, log2(@as(f80, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f66p-24, log2(@as(f80, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fd5ecp-52, log2(@as(f80, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(0x2.e2a8eca5705fc2ecp-64, log2(@as(f80, 0x1.0000000000000002p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f66p-24, log2(@as(f80, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fd5ecp-52, log2(@as(f80, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(0x2.e2a8eca5705fc2ecp-64, log2(@as(f80, 0x1.0000000000000002p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f66p-24, log2(@as(f80, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fd5ecp-52, log2(@as(f80, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(0x2.e2a8eca5705fc2ecp-64, log2(@as(f80, 0x1.0000000000000002p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85fp-24, log2(@as(f80, 0xf.fffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85fp-24, log2(@as(f80, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f39ep-56, log2(@as(f80, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85fp-24, log2(@as(f80, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f39ep-56, log2(@as(f80, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(-0x1.71547652b82fe178p-64, log2(@as(f80, 0xf.fffffffffffffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85fp-24, log2(@as(f80, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f39ep-56, log2(@as(f80, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(-0x1.71547652b82fe178p-64, log2(@as(f80, 0xf.fffffffffffffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f80, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85fp-24, log2(@as(f80, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f39ep-56, log2(@as(f80, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(-0x1.71547652b82fe178p-64, log2(@as(f80, 0xf.fffffffffffffffp-4)));
    try std.testing.expectEqual(0x3.6a6846287159cebp-4, log2(@as(f80, 0x1.28d3b4p+0)));
    try std.testing.expectEqual(-0x1.b8bdee5bd428254ep-4, log2(@as(f80, 0xe.d99dap-4)));
    try std.testing.expectEqual(0x7.999f2a94857b22ep-4, log2(@as(f80, 0x1.63d204p+0)));
    try std.testing.expectEqual(0x7.999f095d7e150198p-4, log2(@as(f80, 0x1.63d202p+0)));
    try std.testing.expectEqual(0x7.999f16e03b54e0f8p-4, log2(@as(f80, 0x1.63d202d04392cp+0)));
    try std.testing.expectEqual(-0x3.75cc3f2233d65c7p-8, log2(@as(f80, 0xf.d9ce1p-4)));
    try std.testing.expectEqual(-0x3.75cdb3f0a0b65598p-8, log2(@as(f80, 0xf.d9cep-4)));
    try std.testing.expectEqual(-0x3.75ccb13d89cc66fp-8, log2(@as(f80, 0xf.d9ce0b1a50e08p-4)));
    try std.testing.expectEqual(0xa.5959448ade0bdcbp-8, log2(@as(f80, 0x1.07465cp+0)));
    try std.testing.expectEqual(0xa.5956764b14a9d7ep-8, log2(@as(f80, 0x1.07465ap+0)));
    try std.testing.expectEqual(0xa.595912bb7fff0bap-8, log2(@as(f80, 0x1.07465bdc7e41cp+0)));
    try std.testing.expectEqual(0xa.595912bb7fe899ap-8, log2(@as(f80, 0x1.07465bdc7e41bp+0)));
    try std.testing.expectEqual(0xa.595912bb7fefdddp-8, log2(@as(f80, 0x1.07465bdc7e41b52ep+0)));
    try std.testing.expectEqual(-0x2.c106931f2bfd0af4p+4, log2(@as(f80, 0xf.4dfb4p-48)));
    try std.testing.expectEqual(0xe.a1dd43a221d02a3p-8, log2(@as(f80, 0x1.0a588ep+0)));
    try std.testing.expectEqual(-0x6.d35688edc44a496p-4, log2(@as(f80, 0xb.e77c6p-4)));
    try std.testing.expectEqual(0x6.44f92e0fda7d1b48p-4, log2(@as(f80, 0x1.4fe37ep+0)));
    try std.testing.expectEqual(0x9.d9a8c6de3432cp+0, log2(@as(f80, 0x3.9b0754p+8)));
    try std.testing.expectEqual(-0x6.df8b2c2c5ea4p-4, log2(@as(f80, 0xb.e132ap-4)));
    try std.testing.expectEqual(-0x7.e842050c531d023p-4, log2(@as(f80, 0xb.5bf83p-4)));
    try std.testing.expectEqual(-0x7.e842258fcc5d9f3p-4, log2(@as(f80, 0xb.5bf82p-4)));
    try std.testing.expectEqual(-0x7.e8420994680da578p-4, log2(@as(f80, 0xb.5bf82dc51f028p-4)));
    try std.testing.expectEqual(-0x7.e8420994680ea99p-4, log2(@as(f80, 0xb.5bf82dc51f02p-4)));
    try std.testing.expectEqual(-0x7.e8420994680ea2d8p-4, log2(@as(f80, 0xb.5bf82dc51f02035p-4)));
    try std.testing.expectEqual(-0x7.b18b6b68ffa23508p-4, log2(@as(f80, 0xb.7704ep-4)));
    try std.testing.expectEqual(-0x7.b18b8b9fc309de5p-4, log2(@as(f80, 0xb.7704dp-4)));
    try std.testing.expectEqual(-0x7.b18b723cc4c4fae8p-4, log2(@as(f80, 0xb.7704dc9beb05p-4)));
    try std.testing.expectEqual(-0x7.f27149af9dc8b0fp-4, log2(@as(f80, 0xb.56f64p-4)));
    try std.testing.expectEqual(-0x7.f2716a4172a70438p-4, log2(@as(f80, 0xb.56f63p-4)));
    try std.testing.expectEqual(-0x7.f27151a15d70d158p-4, log2(@as(f80, 0xb.56f63c18e93fp-4)));
    try std.testing.expectEqual(-0x7.f27151a15d71d5e8p-4, log2(@as(f80, 0xb.56f63c18e93e8p-4)));
    try std.testing.expectEqual(-0x7.f27151a15d70f868p-4, log2(@as(f80, 0xb.56f63c18e93eecdp-4)));
    try std.testing.expectEqual(-0x7.f84a9424a2fba58p-4, log2(@as(f80, 0xb.54171p-4)));
    try std.testing.expectEqual(-0x7.f84ab4beb988b358p-4, log2(@as(f80, 0xb.5417p-4)));
    try std.testing.expectEqual(-0x7.f84a998412a436a8p-4, log2(@as(f80, 0xb.54170d5cfa9p-4)));
    try std.testing.expectEqual(-0x7.f84a998412a53b78p-4, log2(@as(f80, 0xb.54170d5cfa8f8p-4)));
    try std.testing.expectEqual(-0x7.f84a998412a489dp-4, log2(@as(f80, 0xb.54170d5cfa8fd73p-4)));
    try std.testing.expectEqual(-0x7.f84a998412a489fp-4, log2(@as(f80, 0xb.54170d5cfa8fd72p-4)));
    try std.testing.expectEqual(-0x7.ep+4, log2(@as(f80, 0x4p-128)));
    try std.testing.expectEqual(-0x3.fep+8, log2(@as(f80, 0x4p-1024)));
    try std.testing.expectEqual(-0x3.ffep+12, log2(@as(f80, 0x4p-16384)));
    try std.testing.expectEqual(-0x3.fffp+12, log2(@as(f80, 0x2p-16384)));
    try std.testing.expectEqual(-0x3.c9p+8, log2(@as(f80, 0x8p-972)));
    try std.testing.expectEqual(-0x9.5p+4, log2(@as(f80, 0x8p-152)));
    try std.testing.expectEqual(-0x4.32p+8, log2(@as(f80, 0x4p-1076)));
    try std.testing.expectEqual(-0x4.03dp+12, log2(@as(f80, 0x8p-16448)));
    try std.testing.expectEqual(0x7.ffffffe8eab88f48p+4, log2(@as(f80, 0xf.fffffp+124)));
    try std.testing.expectEqual(0x3.fffffffffffffff4p+8, log2(@as(f80, 0xf.ffffffffffff8p+1020)));
    try std.testing.expectEqual(0x4p+12, log2(@as(f80, 0xf.fffffffffffffffp+16380)));

    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(0x1.715477b6069b2d4b70c9ce6a329p+0, log2(@as(f128, 0x2.b7e154p+0)));
    try std.testing.expectEqual(0x1.715475968cddc4e6c2b1cbd1a7c8p+0, log2(@as(f128, 0x2.b7e15p+0)));
    try std.testing.expectEqual(0x1.71547652b82fecebf2ef1ac7b6dep+0, log2(@as(f128, 0x2.b7e151628aed4p+0)));
    try std.testing.expectEqual(0x1.71547652b82fdbf024ffffda5e62p+0, log2(@as(f128, 0x2.b7e151628aed2p+0)));
    // try std.testing.expectEqual(0x1.71547652b82fe1782731bf3f6b29p+0, log2(@as(f128, 0x2.b7e151628aed2a6cp+0)));
    try std.testing.expectEqual(0x1.71547652b82fe17607b8015c0d7ep+0, log2(@as(f128, 0x2.b7e151628aed2a68p+0)));
    try std.testing.expectEqual(0x1.71547652b82fe1777d0ffda0d23bp+0, log2(@as(f128, 0x2.b7e151628aed2a6abf7158809cf6p+0)));
    try std.testing.expectEqual(0x1.71547652b82fe1777d0ffda0d23ap+0, log2(@as(f128, 0x2.b7e151628aed2a6abf7158809cf4p+0)));
    try std.testing.expectEqual(0x1.71547652b82fe1777d0ffda0d24p+0, log2(@as(f128, 0x2.b7e151628aed2a6abf7158809dp+0)));
    try std.testing.expectEqual(0x1.71547652b82fe1777d0ffda0d1b8p+0, log2(@as(f128, 0x2.b7e151628aed2a6abf7158809cp+0)));
    try std.testing.expectEqual(0x1p+0, log2(@as(f128, 0x2p+0)));
    try std.testing.expectEqual(0x4p+0, log2(@as(f128, 0x1p+4)));
    try std.testing.expectEqual(0x8p+0, log2(@as(f128, 0x1p+8)));
    // try std.testing.expectEqual(-0x6.a3fe5c6042978605ff4edf5f9744p-4, log2(@as(f128, 0xcp-4)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f65fd01efaf723e4p-24, log2(@as(f128, 0x1.000002p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f65fd01efaf723e4p-24, log2(@as(f128, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fd5ecd95d67df53aap-52, log2(@as(f128, 0x1.0000000000001p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f65fd01efaf723e4p-24, log2(@as(f128, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fd5ecd95d67df53aap-52, log2(@as(f128, 0x1.0000000000001p+0)));
    // try std.testing.expectEqual(0x2.e2a8eca5705fc2ec17770e9c3416p-64, log2(@as(f128, 0x1.0000000000000002p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f65fd01efaf723e4p-24, log2(@as(f128, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fd5ecd95d67df53aap-52, log2(@as(f128, 0x1.0000000000001p+0)));
    // try std.testing.expectEqual(0x2.e2a8eca5705fc2ec17770e9c3416p-64, log2(@as(f128, 0x1.0000000000000002p+0)));
    try std.testing.expectEqual(0xb.8aa3b295c17f0bbbe87fed068efp-108, log2(@as(f128, 0x1.000000000000000000000000008p+0)));
    try std.testing.expectEqual(0x2.e2a8e9c2c776f65fd01efaf723e4p-24, log2(@as(f128, 0x1.000002p+0)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(0x1.71547652b82fd5ecd95d67df53aap-52, log2(@as(f128, 0x1.0000000000001p+0)));
    // try std.testing.expectEqual(0x2.e2a8eca5705fc2ec17770e9c3416p-64, log2(@as(f128, 0x1.0000000000000002p+0)));
    try std.testing.expectEqual(0x1.71547652b82fe1777d0ffda0d23ap-112, log2(@as(f128, 0x1.0000000000000000000000000001p+0)));
    try std.testing.expectEqual(0xb.8aa3b295c17f0bbbe87fed068efp-108, log2(@as(f128, 0x1.000000000000000000000000008p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85efbccdf68d2e98p-24, log2(@as(f128, 0xf.fffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85efbccdf68d2e98p-24, log2(@as(f128, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f39e6774a440c8ef8p-56, log2(@as(f128, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85efbccdf68d2e98p-24, log2(@as(f128, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f39e6774a440c8ef8p-56, log2(@as(f128, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(-0x1.71547652b82fe17835ba38ca2e52p-64, log2(@as(f128, 0xf.fffffffffffffffp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85efbccdf68d2e98p-24, log2(@as(f128, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f39e6774a440c8ef8p-56, log2(@as(f128, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(-0x1.71547652b82fe17835ba38ca2e52p-64, log2(@as(f128, 0xf.fffffffffffffffp-4)));
    try std.testing.expectEqual(-0x5.c551d94ae0bf85ddf43ff68349a4p-108, log2(@as(f128, 0xf.fffffffffffffffffffffffffcp-4)));
    try std.testing.expectEqual(0x0p+0, log2(@as(f128, 0x1p+0)));
    try std.testing.expectEqual(-0x1.7154770b626b85efbccdf68d2e98p-24, log2(@as(f128, 0xf.fffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f39e6774a440c8ef8p-56, log2(@as(f128, 0xf.ffffffffffff8p-4)));
    try std.testing.expectEqual(-0x1.71547652b82fe17835ba38ca2e52p-64, log2(@as(f128, 0xf.fffffffffffffffp-4)));
    try std.testing.expectEqual(-0xb.8aa3b295c17f0bbbe87fed0691d8p-116, log2(@as(f128, 0xf.fffffffffffffffffffffffffff8p-4)));
    try std.testing.expectEqual(-0x5.c551d94ae0bf85ddf43ff68349a4p-108, log2(@as(f128, 0xf.fffffffffffffffffffffffffcp-4)));
    // try std.testing.expectEqual(0x3.6a6846287159ceb1f8d965deea72p-4, log2(@as(f128, 0x1.28d3b4p+0)));
    // try std.testing.expectEqual(-0x1.b8bdee5bd428254ebf7ead086211p-4, log2(@as(f128, 0xe.d99dap-4)));
    try std.testing.expectEqual(0x7.999f2a94857b22e23de191021e94p-4, log2(@as(f128, 0x1.63d204p+0)));
    // try std.testing.expectEqual(0x7.999f095d7e150199097308f7442p-4, log2(@as(f128, 0x1.63d202p+0)));
    try std.testing.expectEqual(0x7.999f16e03b54e0f55354326ba2c8p-4, log2(@as(f128, 0x1.63d202d04392cp+0)));
    try std.testing.expectEqual(-0x3.75cc3f2233d65c71f491713f54c8p-8, log2(@as(f128, 0xf.d9ce1p-4)));
    // try std.testing.expectEqual(-0x3.75cdb3f0a0b655972857a48ecdfap-8, log2(@as(f128, 0xf.d9cep-4)));
    try std.testing.expectEqual(-0x3.75ccb13d89cc66ee72a7e068c0eap-8, log2(@as(f128, 0xf.d9ce0b1a50e08p-4)));
    // try std.testing.expectEqual(0xa.5959448ade0bdcb61198f8dd2668p-8, log2(@as(f128, 0x1.07465cp+0)));
    try std.testing.expectEqual(0xa.5956764b14a9d7da921863b84bbp-8, log2(@as(f128, 0x1.07465ap+0)));
    // try std.testing.expectEqual(0xa.595912bb7fff0ba2d9d999b5e918p-8, log2(@as(f128, 0x1.07465bdc7e41cp+0)));
    // try std.testing.expectEqual(0xa.595912bb7fe899a4a195bab67568p-8, log2(@as(f128, 0x1.07465bdc7e41bp+0)));
    try std.testing.expectEqual(0xa.595912bb7fefddcbce0cb3878e3p-8, log2(@as(f128, 0x1.07465bdc7e41b52ep+0)));
    try std.testing.expectEqual(-0x2.c106931f2bfd0af427fc474396bp+4, log2(@as(f128, 0xf.4dfb4p-48)));
    try std.testing.expectEqual(0xe.a1dd43a221d02a32622e9cba02cp-8, log2(@as(f128, 0x1.0a588ep+0)));
    // try std.testing.expectEqual(-0x6.d35688edc44a495fd74b5e1b8d9cp-4, log2(@as(f128, 0xb.e77c6p-4)));
    try std.testing.expectEqual(0x6.44f92e0fda7d1b46e2bc2dcfa988p-4, log2(@as(f128, 0x1.4fe37ep+0)));
    try std.testing.expectEqual(0x9.d9a8c6de3432bff9b0fef9633f8p+0, log2(@as(f128, 0x3.9b0754p+8)));
    // try std.testing.expectEqual(-0x6.df8b2c2c5ea400001520bc941b08p-4, log2(@as(f128, 0xb.e132ap-4)));
    // try std.testing.expectEqual(-0x7.e842050c531d02307168b728f45cp-4, log2(@as(f128, 0xb.5bf83p-4)));
    // try std.testing.expectEqual(-0x7.e842258fcc5d9f2cd3d1ec3f0854p-4, log2(@as(f128, 0xb.5bf82p-4)));
    try std.testing.expectEqual(-0x7.e8420994680da57678fdcfd1bea8p-4, log2(@as(f128, 0xb.5bf82dc51f028p-4)));
    // try std.testing.expectEqual(-0x7.e8420994680ea992427e98066258p-4, log2(@as(f128, 0xb.5bf82dc51f02p-4)));
    // try std.testing.expectEqual(-0x7.e8420994680ea2d70a67a2d80578p-4, log2(@as(f128, 0xb.5bf82dc51f02035p-4)));
    // try std.testing.expectEqual(-0x7.b18b6b68ffa235098af8c5c4f5d4p-4, log2(@as(f128, 0xb.7704ep-4)));
    // try std.testing.expectEqual(-0x7.b18b8b9fc309de4f9564e0281104p-4, log2(@as(f128, 0xb.7704dp-4)));
    try std.testing.expectEqual(-0x7.b18b723cc4c4faeb8adda8e96a08p-4, log2(@as(f128, 0xb.7704dc9beb05p-4)));
    // try std.testing.expectEqual(-0x7.f27149af9dc8b0f1993d141d1a5p-4, log2(@as(f128, 0xb.56f64p-4)));
    // try std.testing.expectEqual(-0x7.f2716a4172a70437981d6d2faa0cp-4, log2(@as(f128, 0xb.56f63p-4)));
    // try std.testing.expectEqual(-0x7.f27151a15d70d15a62a4c18ae804p-4, log2(@as(f128, 0xb.56f63c18e93fp-4)));
    // try std.testing.expectEqual(-0x7.f27151a15d71d5e90939366e0698p-4, log2(@as(f128, 0xb.56f63c18e93e8p-4)));
    try std.testing.expectEqual(-0x7.f27151a15d70f86944dd429073p-4, log2(@as(f128, 0xb.56f63c18e93eecdp-4)));
    try std.testing.expectEqual(-0x7.f84a9424a2fba583bbaf3ba7a54p-4, log2(@as(f128, 0xb.54171p-4)));
    // try std.testing.expectEqual(-0x7.f84ab4beb988b35b6eb65af72e58p-4, log2(@as(f128, 0xb.5417p-4)));
    // try std.testing.expectEqual(-0x7.f84a998412a436a8365c4397d8f8p-4, log2(@as(f128, 0xb.54170d5cfa9p-4)));
    // try std.testing.expectEqual(-0x7.f84a998412a53b78ea4938468dfcp-4, log2(@as(f128, 0xb.54170d5cfa8f8p-4)));
    // try std.testing.expectEqual(-0x7.f84a998412a489d141bab11c0c3p-4, log2(@as(f128, 0xb.54170d5cfa8fd73p-4)));
    try std.testing.expectEqual(-0x7.f84a998412a489f1dbd12ebaa208p-4, log2(@as(f128, 0xb.54170d5cfa8fd72p-4)));
    // try std.testing.expectEqual(-0x7.f84a998412a489dce921cd17e614p-4, log2(@as(f128, 0xb.54170d5cfa8fd72a47d6bda19068p-4)));
    // try std.testing.expectEqual(-0x7.f84a998412a489dce921cd17decp-4, log2(@as(f128, 0xb.54170d5cfa8fd72a47d6bda194p-4)));
    try std.testing.expectEqual(-0x7.f84a998412a489dce921cd17e6e8p-4, log2(@as(f128, 0xb.54170d5cfa8fd72a47d6bda19p-4)));
    try std.testing.expectEqual(-0x7.ep+4, log2(@as(f128, 0x4p-128)));
    try std.testing.expectEqual(-0x3.fep+8, log2(@as(f128, 0x4p-1024)));
    try std.testing.expectEqual(-0x3.ffep+12, log2(@as(f128, 0x4p-16384)));
    try std.testing.expectEqual(-0x3.fffp+12, log2(@as(f128, 0x2p-16384)));
    try std.testing.expectEqual(-0x3.c9p+8, log2(@as(f128, 0x8p-972)));
    try std.testing.expectEqual(-0x9.5p+4, log2(@as(f128, 0x8p-152)));
    try std.testing.expectEqual(-0x4.32p+8, log2(@as(f128, 0x4p-1076)));
    try std.testing.expectEqual(-0x4.03dp+12, log2(@as(f128, 0x8p-16448)));
    try std.testing.expectEqual(-0x4.03ep+12, log2(@as(f128, 0x4p-16448)));
    try std.testing.expectEqual(-0x4.06ep+12, log2(@as(f128, 0x4p-16496)));
    try std.testing.expectEqual(0x7.ffffffe8eab88f49d947a104332p+4, log2(@as(f128, 0xf.fffffp+124)));
    try std.testing.expectEqual(0x3.fffffffffffffff4755c4d6a3e8p+8, log2(@as(f128, 0xf.ffffffffffff8p+1020)));
    try std.testing.expectEqual(0x3.ffffffffffffffffffe8eab89ad4p+12, log2(@as(f128, 0xf.fffffffffffffffp+16380)));
    try std.testing.expectEqual(0x4p+12, log2(@as(f128, 0xf.fffffffffffffffffffffffffff8p+16380)));
    try std.testing.expectEqual(0x3.fffffffffffffffa3aae26b51f4p+8, log2(@as(f128, 0xf.ffffffffffffbffffffffffffcp+1020)));
}
