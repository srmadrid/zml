const std = @import("std");
const zml = @import("zml");
const atan = zml.float.atan;
const tzml = @import("../zml.zig");

const data_f32: [43]struct { f32, f32 } = .{
    .{ 0x1.921fb6p+0, std.math.inf(f32) },
    .{ -0x1.921fb6p+0, -std.math.inf(f32) },
    .{ 0x0p+0, 0x0p+0 },
    .{ -0x0p+0, -0x0p+0 },
    .{ 0x1.921fb6p+0, 0xf.fffffp+124 },
    .{ -0x1.921fb6p+0, -0xf.fffffp+124 },
    .{ 0xc.90fdbp-4, 0x1p+0 },
    .{ -0xc.90fdbp-4, -0x1p+0 },
    .{ 0xa.4bc7dp-4, 0xcp-4 },
    .{ 0x7.ff557p-8, 0x8p-8 },
    .{ 0x3.ffffecp-12, 0x4p-12 },
    .{ 0x2p-16, 0x2p-16 },
    .{ 0x1p-20, 0x1p-20 },
    .{ 0x8p-28, 0x8p-28 },
    .{ 0x4p-32, 0x4p-32 },
    .{ 0x2p-36, 0x2p-36 },
    .{ 0x1p-40, 0x1p-40 },
    .{ 0x8p-48, 0x8p-48 },
    .{ 0x4p-52, 0x4p-52 },
    .{ 0x2p-56, 0x2p-56 },
    .{ 0x1p-60, 0x1p-60 },
    .{ 0x1.30b6d8p+0, 0x2.8p+0 },
    .{ 0x1.789bd2p+0, 0xap+0 },
    .{ 0x1.921fa4p+0, 0xf.424p+16 },
    .{ 0x1.921fb6p+0, 0x8p+28 },
    .{ 0x1p-100, 0x1p-100 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x0p+0, 0x0p+0 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x0p+0, 0x0p+0 },
    .{ -0x3.9ff7ep-4, -0x3.b02d84p-4 },
    .{ -0x3.348f08p-4, -0x3.3fb708p-4 },
    .{ -0x1.24c032p+0, -0x2.3249ap+0 },
    .{ -0xe.1832ep-4, -0x1.363f46p+0 },
    .{ -0x1.087838p+0, -0x1.ad4c0ap+0 },
    .{ -0x1.522f04p+0, -0x3.eb8e18p+0 },
    .{ 0x1.476166p+0, 0x3.53c188p+0 },
    .{ -0xe.e9f01p-4, -0x1.58c83p+0 },
    .{ 0x9.b0001p-4, 0xb.133b9p-4 },
    .{ 0x4p-128, 0x4p-128 },
    .{ -0x4p-128, -0x4p-128 },
    .{ 0x8p-152, 0x8p-152 },
    .{ -0x8p-152, -0x8p-152 },
};

const data_f64: [53]struct { f64, f64 } = .{
    .{ 0x1.921fb54442d18p+0, std.math.inf(f64) },
    .{ -0x1.921fb54442d18p+0, -std.math.inf(f64) },
    .{ 0x0p+0, 0x0p+0 },
    .{ -0x0p+0, -0x0p+0 },
    .{ 0x1.921fb54442d18p+0, 0xf.fffffp+124 },
    .{ 0x1.921fb54442d18p+0, 0xf.ffffffffffff8p+1020 },
    .{ -0x1.921fb54442d18p+0, -0xf.fffffp+124 },
    .{ -0x1.921fb54442d18p+0, -0xf.ffffffffffff8p+1020 },
    .{ 0xc.90fdaa22168cp-4, 0x1p+0 },
    .{ -0xc.90fdaa22168cp-4, -0x1p+0 },
    .{ 0xa.4bc7d1934f708p-4, 0xcp-4 },
    .{ 0x7.ff556eea5d894p-8, 0x8p-8 },
    .{ 0x3.ffffeaaaab778p-12, 0x4p-12 },
    .{ 0x1.fffffffd55555p-16, 0x2p-16 },
    .{ 0xf.fffffffffaaa8p-24, 0x1p-20 },
    .{ 0x7.ffffffffffff4p-28, 0x8p-28 },
    .{ 0x4p-32, 0x4p-32 },
    .{ 0x2p-36, 0x2p-36 },
    .{ 0x1p-40, 0x1p-40 },
    .{ 0x8p-48, 0x8p-48 },
    .{ 0x4p-52, 0x4p-52 },
    .{ 0x2p-56, 0x2p-56 },
    .{ 0x1p-60, 0x1p-60 },
    .{ 0x1.30b6d796a4da8p+0, 0x2.8p+0 },
    .{ 0x1.789bd2c160054p+0, 0xap+0 },
    .{ 0x1.921fa47d4b30dp+0, 0xf.424p+16 },
    .{ 0x1.921fb54242d18p+0, 0x8p+28 },
    .{ 0x1p-100, 0x1p-100 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x0p+0, 0x0p+0 },
    .{ 0x1p-600, 0x1p-600 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x0p+0, 0x0p+0 },
    .{ 0x4p-1076, 0x4p-1076 },
    .{ -0x3.9ff7e1f81370cp-4, -0x3.b02d84p-4 },
    .{ -0x3.348f092072332p-4, -0x3.3fb708p-4 },
    .{ -0x1.24c032fe9a703p+0, -0x2.3249ap+0 },
    .{ -0xe.1832df50b2398p-4, -0x1.363f46p+0 },
    .{ -0x1.0878377062daep+0, -0x1.ad4c0ap+0 },
    .{ -0x1.522f0408c0e8cp+0, -0x3.eb8e18p+0 },
    .{ 0x1.476165c27ab51p+0, 0x3.53c188p+0 },
    .{ -0xe.e9f00a57b1438p-4, -0x1.58c83p+0 },
    .{ 0x9.b0000da23b9ep-4, 0xb.133b9p-4 },
    .{ 0x4p-128, 0x4p-128 },
    .{ 0x4p-1024, 0x4p-1024 },
    .{ 0x8p-972, 0x8p-972 },
    .{ -0x4p-128, -0x4p-128 },
    .{ -0x4p-1024, -0x4p-1024 },
    .{ -0x8p-972, -0x8p-972 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x4p-1076, 0x4p-1076 },
    .{ -0x8p-152, -0x8p-152 },
    .{ -0x4p-1076, -0x4p-1076 },
};

const data_f80: [62]struct { f80, f80 } = .{
    .{ 0x1.921fb54442d1846ap+0, std.math.inf(f80) },
    .{ -0x1.921fb54442d1846ap+0, -std.math.inf(f80) },
    .{ 0x0p+0, 0x0p+0 },
    .{ -0x0p+0, -0x0p+0 },
    .{ 0x1.921fb54442d1846ap+0, 0xf.fffffp+124 },
    .{ 0x1.921fb54442d1846ap+0, 0xf.ffffffffffff8p+1020 },
    .{ 0x1.921fb54442d1846ap+0, 0xf.fffffffffffffffp+16380 },
    .{ -0x1.921fb54442d1846ap+0, -0xf.fffffp+124 },
    .{ -0x1.921fb54442d1846ap+0, -0xf.ffffffffffff8p+1020 },
    .{ -0x1.921fb54442d1846ap+0, -0xf.fffffffffffffffp+16380 },
    .{ 0xc.90fdaa22168c235p-4, 0x1p+0 },
    .{ -0xc.90fdaa22168c235p-4, -0x1p+0 },
    .{ 0xa.4bc7d1934f70924p-4, 0xcp-4 },
    .{ 0x7.ff556eea5d892a1p-8, 0x8p-8 },
    .{ 0x3.ffffeaaaab77777p-12, 0x4p-12 },
    .{ 0x1.fffffffd5555555cp-16, 0x2p-16 },
    .{ 0xf.fffffffffaaaaabp-24, 0x1p-20 },
    .{ 0x7.ffffffffffff5558p-28, 0x8p-28 },
    .{ 0x3.ffffffffffffffecp-32, 0x4p-32 },
    .{ 0x2p-36, 0x2p-36 },
    .{ 0x1p-40, 0x1p-40 },
    .{ 0x8p-48, 0x8p-48 },
    .{ 0x4p-52, 0x4p-52 },
    .{ 0x2p-56, 0x2p-56 },
    .{ 0x1p-60, 0x1p-60 },
    .{ 0x1.30b6d796a4da858ap+0, 0x2.8p+0 },
    .{ 0x1.789bd2c16005382ep+0, 0xap+0 },
    .{ 0x1.921fa47d4b30ce82p+0, 0xf.424p+16 },
    .{ 0x1.921fb54242d1846ap+0, 0x8p+28 },
    .{ 0x1p-100, 0x1p-100 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x0p+0, 0x0p+0 },
    .{ 0x1p-600, 0x1p-600 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x0p+0, 0x0p+0 },
    .{ 0x4p-1076, 0x4p-1076 },
    .{ 0x1p-10000, 0x1p-10000 },
    .{ -0x3.9ff7e1f81370b93p-4, -0x3.b02d84p-4 },
    .{ -0x3.348f092072331fd8p-4, -0x3.3fb708p-4 },
    .{ -0x1.24c032fe9a702f72p+0, -0x2.3249ap+0 },
    .{ -0xe.1832df50b2398e5p-4, -0x1.363f46p+0 },
    .{ -0x1.0878377062dada2ap+0, -0x1.ad4c0ap+0 },
    .{ -0x1.522f0408c0e8c2d8p+0, -0x3.eb8e18p+0 },
    .{ 0x1.476165c27ab518p+0, 0x3.53c188p+0 },
    .{ -0xe.e9f00a57b143b32p-4, -0x1.58c83p+0 },
    .{ 0x9.b0000da23b9dce3p-4, 0xb.133b9p-4 },
    .{ 0x4p-128, 0x4p-128 },
    .{ 0x4p-1024, 0x4p-1024 },
    .{ 0x4p-16384, 0x4p-16384 },
    .{ 0x2p-16384, 0x2p-16384 },
    .{ 0x8p-972, 0x8p-972 },
    .{ -0x4p-128, -0x4p-128 },
    .{ -0x4p-1024, -0x4p-1024 },
    .{ -0x4p-16384, -0x4p-16384 },
    .{ -0x2p-16384, -0x2p-16384 },
    .{ -0x8p-972, -0x8p-972 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x4p-1076, 0x4p-1076 },
    .{ 0x8p-16448, 0x8p-16448 },
    .{ -0x8p-152, -0x8p-152 },
    .{ -0x4p-1076, -0x4p-1076 },
    .{ -0x8p-16448, -0x8p-16448 },
};

const data_f128: [70]struct { f128, f128 } = .{
    .{ 0x1.921fb54442d18469898cc51701b8p+0, std.math.inf(f128) },
    .{ -0x1.921fb54442d18469898cc51701b8p+0, -std.math.inf(f128) },
    .{ 0x0p+0, 0x0p+0 },
    .{ -0x0p+0, -0x0p+0 },
    .{ 0x1.921fb54442d18469898cc51701b8p+0, 0xf.fffffp+124 },
    .{ 0x1.921fb54442d18469898cc51701b8p+0, 0xf.ffffffffffff8p+1020 },
    .{ 0x1.921fb54442d18469898cc51701b8p+0, 0xf.fffffffffffffffp+16380 },
    .{ 0x1.921fb54442d18469898cc51701b8p+0, 0xf.fffffffffffffffffffffffffff8p+16380 },
    .{ 0x1.921fb54442d18469898cc51701b8p+0, 0xf.ffffffffffffbffffffffffffcp+1020 },
    .{ -0x1.921fb54442d18469898cc51701b8p+0, -0xf.fffffp+124 },
    .{ -0x1.921fb54442d18469898cc51701b8p+0, -0xf.ffffffffffff8p+1020 },
    .{ -0x1.921fb54442d18469898cc51701b8p+0, -0xf.fffffffffffffffp+16380 },
    .{ -0x1.921fb54442d18469898cc51701b8p+0, -0xf.fffffffffffffffffffffffffff8p+16380 },
    .{ -0x1.921fb54442d18469898cc51701b8p+0, -0xf.ffffffffffffbffffffffffffcp+1020 },
    .{ 0xc.90fdaa22168c234c4c6628b80dcp-4, 0x1p+0 },
    .{ -0xc.90fdaa22168c234c4c6628b80dcp-4, -0x1p+0 },
    .{ 0xa.4bc7d1934f7092419a87f2a457d8p-4, 0xcp-4 },
    .{ 0x7.ff556eea5d892a13bcebbb6ed464p-8, 0x8p-8 },
    .{ 0x3.ffffeaaaab77776e52e5a019fbcep-12, 0x4p-12 },
    .{ 0x1.fffffffd5555555bbbbbbba97297p-16, 0x2p-16 },
    .{ 0xf.fffffffffaaaaaaaaaadddddddep-24, 0x1p-20 },
    .{ 0x7.ffffffffffff5555555555556efp-28, 0x8p-28 },
    .{ 0x3.ffffffffffffffeaaaaaaaaaaaaap-32, 0x4p-32 },
    .{ 0x1.fffffffffffffffffd5555555555p-36, 0x2p-36 },
    .{ 0xf.fffffffffffffffffffaaaaaaaa8p-44, 0x1p-40 },
    .{ 0x7.ffffffffffffffffffffff555554p-48, 0x8p-48 },
    .{ 0x3.ffffffffffffffffffffffffeaaap-52, 0x4p-52 },
    .{ 0x1.fffffffffffffffffffffffffffdp-56, 0x2p-56 },
    .{ 0x1p-60, 0x1p-60 },
    .{ 0x1.30b6d796a4da8589532c0eec663ep+0, 0x2.8p+0 },
    .{ 0x1.789bd2c16005382eabf0cd4b6aaep+0, 0xap+0 },
    .{ 0x1.921fa47d4b30ce822275563fcb9ap+0, 0xf.424p+16 },
    .{ 0x1.921fb54242d18469898cc519ac63p+0, 0x8p+28 },
    .{ 0x1p-100, 0x1p-100 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x0p+0, 0x0p+0 },
    .{ 0x1p-600, 0x1p-600 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x0p+0, 0x0p+0 },
    .{ 0x4p-1076, 0x4p-1076 },
    .{ 0x1p-10000, 0x1p-10000 },
    .{ -0x3.9ff7e1f81370b93195e0357d0b5ap-4, -0x3.b02d84p-4 },
    .{ -0x3.348f092072331fd8ca0cbff348d6p-4, -0x3.3fb708p-4 },
    .{ -0x1.24c032fe9a702f7255968f75e01cp+0, -0x2.3249ap+0 },
    .{ -0xe.1832df50b2398e4a96945ef0f7f8p-4, -0x1.363f46p+0 },
    .{ -0x1.0878377062dada2af4f466e46577p+0, -0x1.ad4c0ap+0 },
    .{ -0x1.522f0408c0e8c2d8d3fe682ee8bdp+0, -0x3.eb8e18p+0 },
    .{ 0x1.476165c27ab517ff156a94e45559p+0, 0x3.53c188p+0 },
    .{ -0xe.e9f00a57b143b31a8f4be18ea31p-4, -0x1.58c83p+0 },
    .{ 0x9.b0000da23b9dce2cdb744dda364p-4, 0xb.133b9p-4 },
    .{ 0x4p-128, 0x4p-128 },
    .{ 0x4p-1024, 0x4p-1024 },
    .{ 0x4p-16384, 0x4p-16384 },
    .{ 0x2p-16384, 0x2p-16384 },
    .{ 0x8p-972, 0x8p-972 },
    .{ -0x4p-128, -0x4p-128 },
    .{ -0x4p-1024, -0x4p-1024 },
    .{ -0x4p-16384, -0x4p-16384 },
    .{ -0x2p-16384, -0x2p-16384 },
    .{ -0x8p-972, -0x8p-972 },
    .{ 0x8p-152, 0x8p-152 },
    .{ 0x4p-1076, 0x4p-1076 },
    .{ 0x8p-16448, 0x8p-16448 },
    .{ 0x4p-16448, 0x4p-16448 },
    .{ 0x4p-16496, 0x4p-16496 },
    .{ -0x8p-152, -0x8p-152 },
    .{ -0x4p-1076, -0x4p-1076 },
    .{ -0x8p-16448, -0x8p-16448 },
    .{ -0x4p-16448, -0x4p-16448 },
    .{ -0x4p-16496, -0x4p-16496 },
};

test atan {
    var results_f32: [data_f32.len]f32 = undefined;
    var results_f64: [data_f64.len]f64 = undefined;
    var results_f80: [data_f80.len]f80 = undefined;
    var results_f128: [data_f128.len]f128 = undefined;

    for (0..data_f32.len) |i| {
        results_f32[i] = atan(data_f32[i][1]);
    }

    for (0..data_f64.len) |i| {
        results_f64[i] = atan(data_f64[i][1]);
    }

    for (0..data_f80.len) |i| {
        results_f80[i] = atan(data_f80[i][1]);
    }

    for (0..data_f128.len) |i| {
        results_f128[i] = atan(data_f128[i][1]);
    }

    tzml.float.printReport(
        "float.atan",
        data_f32,
        results_f32,
        data_f64,
        results_f64,
        data_f80,
        results_f80,
        data_f128,
        results_f128,
    );
}
